(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[724],{5372:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return a(7383)}])},7383:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});var r=a(4232),n=a(9099),s=a(5063),i=a(5035),o=a(7874),l=a(6266),c=a(2213),u=a(1745),d=a(1377),h=a(9549),f=a.n(h),m=a(7876);function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var r,n,s,i,o=[],l=!0,c=!1;try{if(s=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;l=!1}else for(;!(l=(r=s.call(a)).done)&&(o.push(r.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=a.return&&(i=a.return(),Object(i)!==i))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return _(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if("Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return _(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=Array(t);a<t;a++)r[a]=e[a];return r}var j="https://brainbytes-backend-oj3s.onrender.com";function g(){var e=b((0,r.useState)("all"),2),t=e[0],a=e[1],h=b((0,r.useState)(null),2),_=h[0],g=h[1],x=b((0,r.useState)([]),2),y=x[0],p=x[1],v=b((0,r.useState)({totalMessages:0,uniqueSessions:0,mostActiveDay:"N/A",categoryData:[]}),2),D=v[0],N=v[1],C=(0,n.useRouter)(),S=function(e,t){if("all"===t)return e;var a=new Date;return e.filter(function(e){var r=new Date(e.timestamp);if(isNaN(r))return!1;if("today"===t)return r.toDateString()===a.toDateString();if("week"===t){var n=new Date;return n.setDate(a.getDate()-7),r>=n}if("month"===t){var s=new Date;return s.setMonth(a.getMonth()-1),r>=s}return!0})},k=function(){var e=localStorage.getItem("userId");e&&(fetch("".concat(j,"/api/user/").concat(e)).then(function(e){return e.json()}).then(function(e){return g(e.user||e)}),fetch("".concat(j,"/api/messages/recent/").concat(e)).then(function(e){return e.json()}).then(function(e){var a,r=e.messages||[];p(r=S(r,t));var n=r.length,s=new Set(r.map(function(e){return e.sessionId})),i={},o={};r.forEach(function(e){var t=new Date(e.timestamp).toLocaleDateString();if(i[t]=(i[t]||0)+1,e.category){var a=e.category.trim();o[a]=(o[a]||0)+1}});var l=(null==(a=Object.entries(i).sort(function(e,t){return t[1]-e[1]})[0])?void 0:a[0])||"N/A",c=Object.entries(o).map(function(e){var t=b(e,2);return{category:t[0],count:t[1]}});console.log("[Topic Data for Chart]",c),N({totalMessages:n,uniqueSessions:s.size,mostActiveDay:l,categoryData:c})}))};return((0,r.useEffect)(function(){k()},[t]),_)?(0,m.jsx)("div",{className:f().dashboardWrapper,children:(0,m.jsxs)("div",{className:f().dashboardCard,children:[(0,m.jsx)("div",{className:f().backButtonContainer,children:(0,m.jsx)("button",{className:f().backButton,onClick:function(){k(),setTimeout(function(){return C.back()},200)},children:"â† Back"})}),(0,m.jsxs)("h1",{className:f().header,children:["Welcome, ",_.name||"User"]}),(0,m.jsxs)("p",{className:f().infoText,children:[(0,m.jsx)("strong",{children:"Email:"})," ",_.email||"N/A"]}),(0,m.jsxs)("p",{className:f().infoText,children:[(0,m.jsx)("strong",{children:"Joined:"})," ",_.createdAt?new Date(_.createdAt).toLocaleDateString():"N/A"]}),(0,m.jsxs)("div",{className:f().filterContainer,children:[(0,m.jsx)("label",{htmlFor:"timeFilter",children:"Filter by:"}),(0,m.jsxs)("select",{id:"timeFilter",value:t,onChange:function(e){return a(e.target.value)},className:f().filterSelect,children:[(0,m.jsx)("option",{value:"all",children:"All Time"}),(0,m.jsx)("option",{value:"today",children:"Today"}),(0,m.jsx)("option",{value:"week",children:"This Week"}),(0,m.jsx)("option",{value:"month",children:"This Month"})]})]}),(0,m.jsx)("h3",{className:f().sectionTitle,children:"Analytics Summary"}),(0,m.jsxs)("ul",{className:f().analyticsList,children:[(0,m.jsxs)("li",{children:["Total Messages: ",D.totalMessages]}),(0,m.jsxs)("li",{children:["Unique Sessions: ",D.uniqueSessions]}),(0,m.jsxs)("li",{children:["Most Active Day: ",D.mostActiveDay]})]}),(0,m.jsx)("h3",{className:f().sectionTitle,children:"Most Common Topics"}),D.categoryData.length>0?(0,m.jsx)("div",{className:f().chartContainer,children:(0,m.jsx)(s.u,{width:"100%",height:250,children:(0,m.jsxs)(i.E,{data:D.categoryData,children:[(0,m.jsx)(o.d,{strokeDasharray:"3 3"}),(0,m.jsx)(l.W,{dataKey:"category",tick:{fontSize:10},interval:0,angle:-30,textAnchor:"end"}),(0,m.jsx)(c.h,{allowDecimals:!1}),(0,m.jsx)(u.m,{}),(0,m.jsx)(d.y,{dataKey:"count",fill:"#82ca9d"})]})})}):(0,m.jsx)("p",{children:"No topic data available."}),(0,m.jsx)("h3",{className:f().sectionTitle,children:"Recent Messages"}),y.length>0?(0,m.jsx)("ul",{className:f().messageList,children:y.map(function(e){return(0,m.jsxs)("li",{className:f().messageItem,onClick:function(){return C.push("/chat?sessionid=".concat(e.sessionId))},style:{cursor:"pointer"},children:[(0,m.jsxs)("strong",{children:[e.sender,":"]})," ",e.text]},e._id)})}):(0,m.jsx)("p",{children:"No recent messages found."})]})}):(0,m.jsx)("div",{className:f().dashboardWrapper,children:"Loading dashboard..."})}function x(){return(0,m.jsx)(g,{})}},9549:e=>{e.exports={dashboardWrapper:"ProfileDashboard_dashboardWrapper__KvHIV",dashboardCard:"ProfileDashboard_dashboardCard__ZhyQz",backButtonContainer:"ProfileDashboard_backButtonContainer__vlMbO",backButton:"ProfileDashboard_backButton__U4wEt",header:"ProfileDashboard_header__xJCG4",infoText:"ProfileDashboard_infoText__l81bf",sectionTitle:"ProfileDashboard_sectionTitle__PCEBd",messageList:"ProfileDashboard_messageList__PCu4k",messageItem:"ProfileDashboard_messageItem__W4BZz",analyticsList:"ProfileDashboard_analyticsList__tnjLT",chartContainer:"ProfileDashboard_chartContainer__q1I37",filterContainer:"ProfileDashboard_filterContainer__lXP1Q",filterSelect:"ProfileDashboard_filterSelect__CKJRW"}}},e=>{var t=t=>e(e.s=t);e.O(0,[911,636,593,792],()=>t(5372)),_N_E=e.O()}]);